# –≠–¢–ê–ü 2: –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ {{name}} - –ó–ê–í–ï–†–®–ï–ù ‚úÖ

## –î–∞—Ç–∞: 01.10.2025

## –¶–µ–ª—å —ç—Ç–∞–ø–∞
–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–ª—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ email-–ø–∏—Å–µ–º —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –≤—Å—Ç–∞–≤–∫–∏ {{firstName}}, {{email}}, {{balance}} –∏ –¥—Ä—É–≥–∏—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö.

---

## –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

### 1. ‚úÖ Backend API –¥–ª—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

**–§–∞–π–ª:** `backend/src/controllers/emailVariablesController.js`

**–≠–Ω–¥–ø–æ–∏–Ω—Ç—ã:**

```javascript
GET    /api/email-variables          // –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
GET    /api/email-variables/:id      // –ü–æ–ª—É—á–∏—Ç—å –æ–¥–Ω—É –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é
POST   /api/email-variables          // –°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é (custom)
PUT    /api/email-variables/:id      // –û–±–Ω–æ–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é
DELETE /api/email-variables/:id      // –£–¥–∞–ª–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é (—Ç–æ–ª—å–∫–æ custom)
```

**–§—É–Ω–∫—Ü–∏–∏:**

1. **getAllVariables(req, res)**
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
   - –§–∏–ª—å—Ç—Ä –ø–æ category: `?category=user|system|custom`
   - –†–µ–∑—É–ª—å—Ç–∞—Ç: `{ variables: [], grouped: {} }`

2. **parseVariables(text)**
   - –ü–∞—Ä—Å–∏—Ç —Ç–µ–∫—Å—Ç –∏ –Ω–∞—Ö–æ–¥–∏—Ç –≤—Å–µ `{{variable}}`
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–∞—Å—Å–∏–≤ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏

3. **replaceVariables(text, userData)**
   - –ó–∞–º–µ–Ω—è–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç userData –¥–ª—è user-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
   - –°–∏—Å—Ç–µ–º–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –±–µ—Ä—É—Ç—Å—è –∏–∑ `getSystemVariable()`
   - Fallback –Ω–∞ `variable.example` –µ—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ

4. **getSystemVariable(key)**
   - –ü–æ–ª—É—á–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:
     - `platformName` ‚Üí 'Wekey Tools'
     - `currentYear` ‚Üí '2025'
     - `currentDate` ‚Üí '01.10.2025'
     - `supportEmail` ‚Üí 'support@wekey.tools'
     - `siteUrl` ‚Üí 'https://wekey.tools'

---

### 2. ‚úÖ –ú–æ–¥–µ–ª—å EmailVariable

**–§–∞–π–ª:** `backend/src/models/EmailVariable.js`

**–°—Ö–µ–º–∞:**
```javascript
{
  id: INTEGER PRIMARY KEY AUTO_INCREMENT,
  key: STRING(100) UNIQUE NOT NULL,       // 'firstName', 'balance', etc.
  description: TEXT,                       // '–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è'
  example: STRING(255),                    // '–ò–≤–∞–Ω'
  category: STRING(50) NOT NULL,          // 'user', 'system', 'custom'
  createdAt: DATE,
  updatedAt: DATE
}
```

**–ò–Ω–¥–µ–∫—Å—ã:**
- UNIQUE –Ω–∞ `key`
- INDEX –Ω–∞ `category`

---

### 3. ‚úÖ –†–æ—É—Ç—ã

**–§–∞–π–ª:** `backend/src/routes/emailVariables.js`

**–ó–∞—â–∏—Ç–∞:** –í—Å–µ —Ä–æ—É—Ç—ã —Ç—Ä–µ–±—É—é—Ç `requireAdmin` middleware

```javascript
router.get('/', emailVariablesController.getAllVariables);
router.get('/:id', emailVariablesController.getVariable);
router.post('/', emailVariablesController.createVariable);
router.put('/:id', emailVariablesController.updateVariable);
router.delete('/:id', emailVariablesController.deleteVariable);
```

**–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ app.js:**
```javascript
app.use('/api/email-variables', emailVariablesRoutes);
```

---

### 4. ‚úÖ React Hook: useEmailVariables

**–§–∞–π–ª:** `frontend/src/hooks/useEmailVariables.ts`

**–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å:**
```typescript
interface EmailVariable {
  id: number;
  key: string;
  description: string;
  example: string;
  category: 'user' | 'system' | 'custom';
}

interface GroupedVariables {
  [category: string]: EmailVariable[];
}
```

**–§—É–Ω–∫—Ü–∏–∏ —Ö—É–∫–∞:**

1. **fetchVariables(category?)** - –∑–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
2. **getVariable(id)** - –ø–æ–ª—É—á–∏—Ç—å –æ–¥–Ω—É –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é
3. **createVariable(data)** - —Å–æ–∑–¥–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é
4. **updateVariable(id, data)** - –æ–±–Ω–æ–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é
5. **deleteVariable(id)** - —É–¥–∞–ª–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é
6. **parseVariables(text)** - –ø–∞—Ä—Å–∏–Ω–≥ `{{var}}` –∏–∑ —Ç–µ–∫—Å—Ç–∞
7. **replaceWithExamples(text)** - –∑–∞–º–µ–Ω–∞ –Ω–∞ –ø—Ä–∏–º–µ—Ä—ã
8. **replaceWithValues(text, userData)** - –∑–∞–º–µ–Ω–∞ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
9. **getUsedVariables(text)** - —Å–ø–∏—Å–æ–∫ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

**State:**
```typescript
{
  variables: EmailVariable[],
  grouped: GroupedVariables,
  loading: boolean,
  error: string | null
}
```

---

### 5. ‚úÖ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç VariableInserter

**–§–∞–π–ª:** `frontend/src/components/admin/newsletters/VariableInserter.tsx`

**Props:**
```typescript
interface VariableInserterProps {
  onInsert: (variable: string) => void;
  buttonText?: string;
  buttonIcon?: string;
  position?: 'left' | 'right';
}
```

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**

1. **Dropdown –º–µ–Ω—é** —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏
2. **–ü–æ–∏—Å–∫** –ø–æ –∫–ª—é—á—É –∏ –æ–ø–∏—Å–∞–Ω–∏—é
3. **–¢–∞–±—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–π:**
   - –í—Å–µ
   - üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (user)
   - ‚öôÔ∏è –°–∏—Å—Ç–µ–º–∞ (system)
   - üé® –ö–∞—Å—Ç–æ–º–Ω—ã–µ (custom)

4. **–ö–∞—Ä—Ç–æ—á–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π:**
   ```
   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
   ‚îÇ üë§ {{firstName}}             ‚îÇ
   ‚îÇ –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è             ‚îÇ
   ‚îÇ –ü—Ä–∏–º–µ—Ä: –ò–≤–∞–Ω                 ‚îÇ
   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
   ```

5. **–í—Å—Ç–∞–≤–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π** –ø–æ –∫–ª–∏–∫—É
6. **–ó–∞–∫—Ä—ã—Ç–∏–µ** –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ
7. **–ê–≤—Ç–æ—Ñ–æ–∫—É—Å** –Ω–∞ –ø–æ–ª–µ –ø–æ–∏—Å–∫–∞
8. **Hint –≤ footer** —Å –ø–æ–¥—Å–∫–∞–∑–∫–æ–π

---

### 6. ‚úÖ –°—Ç–∏–ª–∏ VariableInserter

**–§–∞–π–ª:** `frontend/src/components/admin/newsletters/VariableInserter.css`

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**

1. **Dropdown –∞–Ω–∏–º–∞—Ü–∏—è:**
   ```css
   @keyframes dropdownSlideIn {
     from { opacity: 0; transform: translateY(-10px); }
     to { opacity: 1; transform: translateY(0); }
   }
   ```

2. **Hover —ç—Ñ—Ñ–µ–∫—Ç—ã:**
   - –ö–∞—Ä—Ç–æ—á–∫–∏ —Å–¥–≤–∏–≥–∞—é—Ç—Å—è –≤–ø—Ä–∞–≤–æ –Ω–∞ 4px
   - –†–∞–º–∫–∞ –ø–æ–¥—Å–≤–µ—á–∏–≤–∞–µ—Ç—Å—è —Ü–≤–µ—Ç–æ–º #5E35F2
   - –ü–ª–∞–≤–Ω—ã–π transition 0.2s

3. **–ê–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è:**
   - –ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Ñ–æ–Ω (—Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π ‚Üí —Ä–æ–∑–æ–≤—ã–π)
   - –ë–µ–ª—ã–π —Ç–µ–∫—Å—Ç
   - –ë–µ–∑ —Ä–∞–º–∫–∏

4. **–ö–∞—Å—Ç–æ–º–Ω—ã–π —Å–∫—Ä–æ–ª–ª–±–∞—Ä:**
   - –¢–æ–Ω–∫–∏–π (6px)
   - –¶–≤–µ—Ç: #333335
   - Hover: #444446

5. **Footer —Å –ø–æ–¥—Å–∫–∞–∑–∫–æ–π:**
   - Gradient —Ñ–æ–Ω rgba(94, 53, 242, 0.05)
   - –ò–∫–æ–Ω–∫–∞ üí°
   - –ú–µ–ª–∫–∏–π —à—Ä–∏—Ñ—Ç (11px)

---

## –ü—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (14 —à—Ç)

### üë§ USER (9 –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö):
```
{{name}}              - –ü–æ–ª–Ω–æ–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è    ‚Üí "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤"
{{firstName}}         - –ò–º—è                        ‚Üí "–ò–≤–∞–Ω"
{{lastName}}          - –§–∞–º–∏–ª–∏—è                    ‚Üí "–ò–≤–∞–Ω–æ–≤"
{{email}}             - Email –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è         ‚Üí "user@example.com"
{{balance}}           - –ë–∞–ª–∞–Ω—Å –∫–æ–∏–Ω–æ–≤              ‚Üí "100"
{{registrationDate}}  - –î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏           ‚Üí "01.10.2025"
{{lastLoginDate}}     - –ü–æ—Å–ª–µ–¥–Ω–∏–π –≤—Ö–æ–¥             ‚Üí "15.10.2025"
{{coinsSpent}}        - –ü–æ—Ç—Ä–∞—á–µ–Ω–æ –∫–æ–∏–Ω–æ–≤           ‚Üí "50"
{{toolsUsed}}         - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤  ‚Üí "5"
```

### ‚öôÔ∏è SYSTEM (5 –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö):
```
{{platformName}}      - –ù–∞–∑–≤–∞–Ω–∏–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã   ‚Üí "Wekey Tools"
{{supportEmail}}      - Email –ø–æ–¥–¥–µ—Ä–∂–∫–∏      ‚Üí "support@wekey.tools"
{{currentYear}}       - –¢–µ–∫—É—â–∏–π –≥–æ–¥          ‚Üí "2025"
{{currentDate}}       - –¢–µ–∫—É—â–∞—è –¥–∞—Ç–∞         ‚Üí "01.10.2025"
{{siteUrl}}           - URL —Å–∞–π—Ç–∞            ‚Üí "https://wekey.tools"
```

---

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### Frontend: –í—Å—Ç–∞–≤–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π

```tsx
import VariableInserter from './VariableInserter';

function EmailEditor() {
  const [content, setContent] = useState('');
  const textareaRef = useRef<HTMLTextAreaElement>(null);

  const handleInsert = (variable: string) => {
    if (textareaRef.current) {
      const start = textareaRef.current.selectionStart;
      const end = textareaRef.current.selectionEnd;
      const newContent = 
        content.substring(0, start) + 
        variable + 
        content.substring(end);
      setContent(newContent);
    }
  };

  return (
    <>
      <VariableInserter 
        onInsert={handleInsert}
        buttonText="–î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é"
        position="left"
      />
      <textarea ref={textareaRef} value={content} />
    </>
  );
}
```

### Backend: –ó–∞–º–µ–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

```javascript
const emailVariablesController = require('./controllers/emailVariablesController');

async function sendEmail(template, userId) {
  const user = await User.findByPk(userId);
  
  const userData = {
    firstName: user.firstName,
    lastName: user.lastName,
    email: user.email,
    balance: user.coinBalance.toString(),
    registrationDate: formatDate(user.createdAt),
    // ... –¥—Ä—É–≥–∏–µ –ø–æ–ª—è
  };
  
  const finalHTML = await emailVariablesController.replaceVariables(
    template.content,
    userData
  );
  
  // –û—Ç–ø—Ä–∞–≤–∫–∞ –ø–∏—Å—å–º–∞ —Å finalHTML
}
```

### Hook: –ü–∞—Ä—Å–∏–Ω–≥ –∏ –∑–∞–º–µ–Ω–∞

```typescript
const { parseVariables, replaceWithExamples, getUsedVariables } = useEmailVariables();

// –ü–∞—Ä—Å–∏–Ω–≥
const vars = parseVariables(template);
// ‚Üí ['firstName', 'balance', 'email']

// –ó–∞–º–µ–Ω–∞ –Ω–∞ –ø—Ä–∏–º–µ—Ä—ã (–¥–ª—è preview)
const preview = replaceWithExamples(template);
// "–ü—Ä–∏–≤–µ—Ç, –ò–≤–∞–Ω!" –≤–º–µ—Å—Ç–æ "–ü—Ä–∏–≤–µ—Ç, {{firstName}}!"

// –ü–æ–ª—É—á–∏—Ç—å –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
const used = getUsedVariables(template);
// ‚Üí [{ id: 1, key: 'firstName', description: '...', ... }]
```

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
backend/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ controllers/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ emailVariablesController.js  ‚≠ê –ù–æ–≤—ã–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä
‚îÇ   ‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ EmailVariable.js             ‚≠ê –ù–æ–≤–∞—è –º–æ–¥–µ–ª—å
‚îÇ   ‚îú‚îÄ‚îÄ routes/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ emailVariables.js            ‚≠ê –ù–æ–≤—ã–µ —Ä–æ—É—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ config/
‚îÇ       ‚îî‚îÄ‚îÄ database.js                  ‚úèÔ∏è –î–æ–±–∞–≤–ª–µ–Ω EmailVariable
‚îú‚îÄ‚îÄ test-email-variables-api.js          üß™ –¢–µ—Å—Ç API
‚îú‚îÄ‚îÄ check-email-variables.js             üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ë–î
‚îî‚îÄ‚îÄ ...

frontend/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ hooks/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ useEmailVariables.ts         ‚≠ê –ù–æ–≤—ã–π hook
‚îÇ   ‚îî‚îÄ‚îÄ components/
‚îÇ       ‚îî‚îÄ‚îÄ admin/
‚îÇ           ‚îî‚îÄ‚îÄ newsletters/
‚îÇ               ‚îú‚îÄ‚îÄ VariableInserter.tsx ‚≠ê –ù–æ–≤—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
‚îÇ               ‚îî‚îÄ‚îÄ VariableInserter.css ‚≠ê –°—Ç–∏–ª–∏
‚îî‚îÄ‚îÄ ...
```

---

## API –ü—Ä–∏–º–µ—Ä—ã

### GET /api/email-variables

**Request:**
```bash
GET /api/email-variables
Authorization: Bearer <adminToken>
```

**Response:**
```json
{
  "success": true,
  "variables": [
    {
      "id": 1,
      "key": "firstName",
      "description": "–ò–º—è",
      "example": "–ò–≤–∞–Ω",
      "category": "user"
    },
    ...
  ],
  "grouped": {
    "user": [...],
    "system": [...],
    "custom": [...]
  }
}
```

### GET /api/email-variables?category=user

**Request:**
```bash
GET /api/email-variables?category=user
Authorization: Bearer <adminToken>
```

**Response:**
```json
{
  "success": true,
  "variables": [
    // –¢–æ–ª—å–∫–æ user-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
  ],
  "grouped": {
    "user": [...]
  }
}
```

### POST /api/email-variables

**Request:**
```bash
POST /api/email-variables
Authorization: Bearer <adminToken>
Content-Type: application/json

{
  "key": "orderNumber",
  "description": "–ù–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞",
  "example": "ORD-12345",
  "category": "custom"
}
```

**Response:**
```json
{
  "success": true,
  "message": "–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è —Å–æ–∑–¥–∞–Ω–∞",
  "variable": {
    "id": 15,
    "key": "orderNumber",
    "description": "–ù–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞",
    "example": "ORD-12345",
    "category": "custom"
  }
}
```

---

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä –ø–∏—Å–µ–º

### –®–∞–≥ 1: –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É –≤ toolbar

```tsx
<div className="editor-toolbar">
  <VariableInserter 
    onInsert={handleInsertVariable}
    buttonIcon="{{}}"
    buttonText="–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è"
    position="left"
  />
  <button>–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</button>
  <button>–ú–µ–¥–∏–∞</button>
</div>
```

### –®–∞–≥ 2: –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—Å—Ç–∞–≤–∫–∏

```typescript
const handleInsertVariable = (variable: string) => {
  // –î–ª—è textarea
  const textarea = textareaRef.current;
  if (textarea) {
    const start = textarea.selectionStart;
    const end = textarea.selectionEnd;
    const newContent = 
      content.substring(0, start) + 
      variable + 
      content.substring(end);
    
    setContent(newContent);
    
    // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫—É—Ä—Å–æ—Ä –ø–æ—Å–ª–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
    setTimeout(() => {
      textarea.selectionStart = textarea.selectionEnd = start + variable.length;
      textarea.focus();
    }, 0);
  }
  
  // –î–ª—è Rich Text Editor
  if (editorRef.current) {
    editorRef.current.insertText(variable);
  }
};
```

### –®–∞–≥ 3: Preview —Å –∑–∞–º–µ–Ω–æ–π

```tsx
const { replaceWithExamples } = useEmailVariables();

function EmailPreview({ content }) {
  const previewHTML = replaceWithExamples(content);
  
  return (
    <div dangerouslySetInnerHTML={{ __html: previewHTML }} />
  );
}
```

---

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ë–î:
```bash
node backend/check-email-variables.js
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
üìä Email Variables in Database: 14

SYSTEM: 5 variables
USER: 9 variables
```

### –¢–µ—Å—Ç API (—Ç—Ä–µ–±—É–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –ø–∞—Ä–æ–ª–µ–º):
```bash
node backend/test-email-variables-api.js
```

---

## –°–ª–µ–¥—É—é—â–∏–µ –∑–∞–¥–∞—á–∏

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ CreateNewsletter:
1. –î–æ–±–∞–≤–∏—Ç—å VariableInserter –≤ toolbar —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞
2. –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—Å—Ç–∞–≤–∫–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
3. Preview —Å –∑–∞–º–µ–Ω–æ–π –Ω–∞ –ø—Ä–∏–º–µ—Ä—ã
4. –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ

### –í–∞–ª–∏–¥–∞—Ü–∏—è:
1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏
2. –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
3. –°–ø–∏—Å–æ–∫ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ–¥ —Ä–µ–¥–∞–∫—Ç–æ—Ä–æ–º

### UI —É–ª—É—á—à–µ–Ω–∏—è:
1. Drag & Drop –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
2. –ë—ã—Å—Ç—Ä—ã–µ –∫–ª–∞–≤–∏—à–∏ (Ctrl+Shift+V)
3. –ü–æ–¥—Å–≤–µ—Ç–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ {{var}}

---

## –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

**–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ:** 2-3 —á–∞—Å–∞  
**–§–∞–∫—Ç–∏—á–µ—Å–∫–∏:** ~2 —á–∞—Å–∞  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–ê–í–ï–†–®–ï–ù

---

## –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏

1. **API –≥–æ—Ç–æ–≤** - –≤—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã
2. **Hook –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω** - –ø–∞—Ä—Å–∏–Ω–≥, –∑–∞–º–µ–Ω–∞, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
3. **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç VariableInserter** - –∫—Ä–∞—Å–∏–≤—ã–π dropdown —Å –ø–æ–∏—Å–∫–æ–º
4. **14 –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã** - –≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
5. **–°–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø** - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä –ø–∏—Å–µ–º

---

**–ê–≤—Ç–æ—Ä:** AI Assistant + Tishakov  
**–î–∞—Ç–∞:** 01.10.2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–û–¢–û–í–û –ö –ò–ù–¢–ï–ì–†–ê–¶–ò–ò

---

## –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è

### Variable Inserter UI:
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ {{}} –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è ‚ñº                      ‚îÇ ‚Üê –ö–Ω–æ–ø–∫–∞
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üîç –ü–æ–∏—Å–∫ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π...                ‚îÇ ‚Üê –ü–æ–∏—Å–∫
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ [–í—Å–µ] [üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å] [‚öôÔ∏è –°–∏—Å—Ç–µ–º–∞]  ‚îÇ ‚Üê –¢–∞–±—ã
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ üë§ {{firstName}}                       ‚îÇ
‚îÇ –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è                       ‚îÇ
‚îÇ –ü—Ä–∏–º–µ—Ä: –ò–≤–∞–Ω                           ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ üë§ {{email}}                           ‚îÇ
‚îÇ Email –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è                     ‚îÇ
‚îÇ –ü—Ä–∏–º–µ—Ä: user@example.com               ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ üí° –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–º–µ–Ω—è—é—Ç—Å—è‚îÇ ‚Üê –ü–æ–¥—Å–∫–∞–∑–∫–∞
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```
